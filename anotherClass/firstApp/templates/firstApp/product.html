{% extends 'firstApp/base.html'%}
{% load static %}

{% block content %}
<link href="{% static 'css/product_custom.css' %}" rel="stylesheet">
<div class="container">
    <div class="product">
        <div class="product-pic">
            {% if class_detail.photo %}
            <img alt="" src="{{ class_detail.photo.url }}">
            {% endif %}
        </div>
        <div class="product-info">
            <h2>{{ class_detail.title }}</h2>
            <div class="center">
                <div class="perprice">{{class_detail.price}} 원</div>
                <div class="hour">/1회</div>
                <div class="onetime">총 1회 {{class_detail.time}} 시간 / 시간당 10,000원</div>
                <img src="{% static 'image\stars.png' %}">
            </div>

            <ul>
                <li>
                    <b>지역 :</b>
                    <a>{{ class_detail.area }}</a>
                </li>

                <li>
                    <b>난이도 :</b>
                    <a>{{ class_detail.level }}</a>
                </li>
                <li>
                    <b>수업방식 :</b>
                    <a>{{ class_detail.mode }}</a>
                </li>
                <li>
                    <div>
                        {% if class_detail.in_min != 1 %}
                        {% if class_detail.in_max != 1 %}
                        <b>최대 인원:</b>
                        {{class_detail.in_min}}명 ~ {{class_detail.in_max}}명
                        {% endif %}
                        {% endif %}
                    </div>
                </li>
                <li>
                    {% if user != class_detail.author %}
                    {% if heart == 1 %}
                    <a href="{% url 'like' class_detail.id %}"><b><img
                            src="https://img.icons8.com/material-sharp/24/000000/like.png"/></b></a>
                    {% else %}
                    <a href="{% url 'like' class_detail.id %}"><b><img
                            src="https://img.icons8.com/metro/26/000000/like.png"/></b></a>
                    {% endif %}
                    {{ class_detail.like_count }}
                    {% else %}
                    <b>좋아요 :</b> {{ class_detail.like_count }}
                    {% endif %}
                </li>
            </ul>
            {% if user != class_detail.author %}
            <b>수강 날짜 선택</b>
            <form action="{% url 'apply' class_detail.id%}" method="get">
                <select name="date">
                    {% for date in class_detail.date_class.all %}
                    <option value="{{date.pk}}">{{ date.date }}</option>
                    {% empty %}
                    {% endfor %}
                </select>
                <br>
                <div>
                <input class="btn btn-primary twobutton" type="submit" value="클래스 신청">
                </div>
            </form>

            {% else %}
            <b>수업 가능 날짜</b>
            <select name="date">
                {% for date in class_detail.date_class.all %}
                <option value="{{date.pk}}">{{ date.date }}</option>
                {% empty %}
                {% endfor %}
            </select>
            <a class="btn btn-primary twobutton" href="{% url 'update_class' class_detail.id %}">
                정보 수정
            </a>
            <a class="btn btn-primary twobutton" href="{% url 'update_time' class_detail.id %}">
                시간 추가
            </a>
            {% endif %}

        </div>
    </div>
    <div class="category-tab shop-details-tab">

        <ul class="nav nav-tabs">
            <li class="active"><a data-toggle="tab" href="#details">클래스 소개</a></li>
            <li><a data-toggle="tab" href="#tutor">강사 정보</a></li>
            <li><a data-toggle="tab" href="#tag">REVIEW</a></li>
            <li><a data-toggle="tab" href="#reviews">Q & A</a></li>
        </ul>

        <div class="tab-content">
            <div class="tab-pane active" id="details">
                <div class="more-container">

                    <div class="con-desc">
                        {{ class_detail.body | safe }}
                    </div>
                </div>
            </div>
            <div class="tab-pane" id="tutor">
                <div class="more-container">
                    <div class="con-desc">
                        <div class="tutor_top">
                            {% if class_detail.tutor_photo %}
                            <img alt="" class="tutor_photo" src="{{ class_detail.tutor_photo.url }}">
                            {% endif %}
                            <div class="tutor_name">{{class_detail.tutor}}</div>
                            <div class="tutor_detail">
                                {% for certificate in class_detail.certi_class.all %}
                                <div><img class="product-q-img" src="{% static 'image\certificate.png' %}">{{
                                    certificate.name}}
                                </div>
                                {% empty %}
                                <p></p>
                                {% endfor %}
                                {% for education in class_detail.edu_class.all %}
                                <div><img class="product-q-img" src="{% static 'image\graduated.png' %}"> {{
                                    education.university}}
                                    {{ education.department}}
                                    {{ education.state}}
                                </div>
                                {% empty %}
                                <p></p>
                                {% endfor %}
                                {% if class_detail.tutor_insta %}
                                <div><img class="product-q-img" src="{% static 'image\insta.png' %}">{{class_detail.tutor_insta}}
                                </div>
                                {% endif %}
                                {% if class_detail.tutor_blog %}
                                <div><img class="product-q-img" src="{% static 'image\blog.png' %}">{{class_detail.tutor_blog}}
                                </div>
                                {% endif %}
                                {% if class_detail.tutor_youtube %}
                                <div><img class="product-q-img" src="{% static 'image\youtube.png' %}">{{class_detail.tutor_youtube}}
                                </div>
                                {% endif %}
                            </div>
                        </div>


                        <div class="tutor_body">{{ class_detail.tutor_body | safe }}</div>
                    </div>
                </div>
            </div>
            <div class="tab-pane" id="tag">
                <div class="more-container">
                    {% for review in class_detail.review_class.all %}
                    <div class="comment">
                        <div class="product-review-date">
                            {{ review.created_date }}
                        </div>
                        <strong><img class="product-review-img" src="{% static 'image\review.png' %}"><span
                                class="product-review-title">{{ review.title }}</span></strong>
                        <p>{{ review.body|linebreaks }}</p>
                    </div>
                    <div class="product-review-hr">
                        <hr>
                    </div>
                    {% empty %}
                    <p></p>
                    {% endfor %}
                </div>
            </div>
            <div class="tab-pane" id="reviews">
                <div class="more-container">
                    {% if user != class_detail.author %}
                    <form class="post-form" method="POST">
                        {% csrf_token %}
                        {{ form.question }}
                        <br>
                        <button class="review-button" type="submit">등록</button>
                    </form>
                    {% endif %}
                    {% for qna in class_detail.qna_class.all %}
                    <div class="comment">
                        <div class="product-review-date">
                            {{ qna.created_date }}
                        </div>
                        <img class="product-q-img" src="{% static 'image\q.png' %}">
                        <div class="product-question">{{ qna.question }}</div>
                        {% if user == class_detail.author %}
                        {% if qna.answer_class.all %}
                        {% for answer in qna.answer_class.all %}

                        {% endfor %}
                        {% else%}
                        <a class="btn btn-primary answer-button" href="{% url 'create_answer' pk=qna.pk %}">답변</a>
                        {% endif %}
                        {% endif %}
                        {% for answer in qna.answer_class.all %}
                        {% if answer.answer %}
                        <div class="product-answer"><img class="product-q-img" src="{% static 'image\a.png' %}">
                            <span>
                    {{ answer.answer }}
                                <a class="btn btn-primary answer-button" href="{% url 'update_answer' pk=answer.pk %}">수정</a>
                {% endif %}
            {% endfor %}
                </span>
                        </div>
                    </div>
                    <div class="product-review-hr">
                        <hr>
                    </div>
                    <p></p>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock content%}


